<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>분리된 금액 입력(정수 · 소수) 예제</title>
<style>
  :root{
    --border:#d6d9e0;
    --focus:#3b82f6;
    --bg:#fff;
    --text:#222;
  }
  body{
    font-family: Pretendard, system-ui, -apple-system, "Segoe UI", Roboto, "Noto Sans KR", "Helvetica Neue", Arial;
    background:#f4f6fb;
    padding:32px;
    color:var(--text);
  }

  h1{font-size:18px;margin-bottom:16px;}

  /* 그룹 형태: 레이블이 전체를 설명 */
  .amount-group{
    display:inline-flex;
    align-items:center;
    gap:6px;
    background:var(--bg);
    border:1px solid var(--border);
    border-radius:10px;
    padding:10px;
    position:relative;
    min-width:260px;
  }
  .amount-group:focus-within{
    border-color:var(--focus);
    box-shadow:0 0 0 4px rgba(59,130,246,0.08);
  }

  .currency{
    font-weight:600;
    min-width:42px;
    text-align:center;
    color:#333;
    padding-right:8px;
  }

  /* 개별 input 스타일 */
  .amount-input{
    border:none;
    outline:none;
    font-size:16px;
    width:90px;
    text-align:right;
    padding:6px 2px;
    background:transparent;
  }
  .amount-input[aria-invalid="true"]{
    border-bottom:2px solid #ff4d4f;
  }

  .dot{
    color:#666;
    font-weight:700;
  }

  /* 개별 클리어 버튼 (각 input에 붙은 형태) */
  .control{
    display:inline-flex;
    align-items:center;
    position:relative;
  }
  .clear-btn{
    /* 버튼은 시맨틱 버튼 (포커스 가능) */
    appearance:none;
    -webkit-appearance:none;
    border:none;
    background:transparent;
    cursor:pointer;
    font-size:14px;
    padding:6px;
    margin-left:6px;
    color:#666;
    display:none; /* 기본 숨김 — 포커스 혹은 값 존재시 보임 */
  }
  .clear-btn:focus{ outline:2px solid rgba(59,130,246,0.2); border-radius:6px; }

  /* 포커스 또는 값 있는 경우 버튼 표시 */
  .control.focused .clear-btn,
  .control.has-value .clear-btn{
    display:inline-block;
  }

  /* 안내 텍스트 */
  .hint{ font-size:13px;color:#666;margin-top:8px; }

  /* 화면리더 전용 설명 */
  .sr-only{
    position:absolute;
    width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0 0 0 0);white-space:nowrap;border:0;
  }

  /* 반응형: 화면 작으면 width 제한 */
  @media (max-width:420px){
    .amount-input{ width:60px; }
    .amount-group{ min-width:200px; }
  }
</style>
</head>
<body>

<h1 id="amount-label">입력금액</h1>

<!-- 그룹: role=group + aria-labelledby 로 전체 레이블 연결 -->
<div class="amount-group" role="group" aria-labelledby="amount-label" aria-describedby="amount-desc">
  <span class="currency" aria-hidden="true">USD</span>

  <!-- 정수부 컨트롤 -->
  <div class="control" id="integer-control">
    <input
      id="integer"
      class="amount-input"
      type="text"
      inputmode="numeric"
      pattern="[0-9]*"
      aria-label="정수 부분"
      autocomplete="off"
      maxlength="6"
      placeholder="직접입력"
    />
    <button type="button" class="clear-btn" id="clear-integer" aria-label="정수 입력 지우기">✕</button>
  </div>

  <span class="dot" aria-hidden="true">.</span>

  <!-- 소수부 컨트롤 -->
  <div class="control" id="decimal-control">
    <input
      id="decimal"
      class="amount-input"
      type="text"
      inputmode="numeric"
      pattern="[0-9]*"
      aria-label="소수 부분"
      autocomplete="off"
      maxlength="2"
      placeholder="00"
    />
    <button type="button" class="clear-btn" id="clear-decimal" aria-label="소수 입력 지우기">✕</button>
  </div>
</div>

<p id="amount-desc" class="hint">이번 달 남은 환율우대 이벤트 한도: USD 300,000.00</p>

<!-- 스크린리더 알림영역 -->
<div class="sr-only" id="sr-announcer" aria-live="polite"></div>

<script>
  // DOM 참조
  const integer = document.getElementById('integer');
  const decimal = document.getElementById('decimal');
  const intControl = document.getElementById('integer-control');
  const decControl = document.getElementById('decimal-control');
  const clearInt = document.getElementById('clear-integer');
  const clearDec = document.getElementById('clear-decimal');
  const announcer = document.getElementById('sr-announcer');

  // 유틸: 숫자만 허용
  function filterNumeric(value){
    return value.replace(/[^0-9]/g, '');
  }

  // 입력 이벤트: 숫자만 남김, maxlength 도달시 포커스 이동(정수->소수)
  integer.addEventListener('input', e => {
    const v = filterNumeric(e.target.value);
    e.target.value = v;
    toggleHasValue(intControl, v);
    if (v.length >= e.target.maxLength) {
      decimal.focus();
      announcer.textContent = '소수 입력으로 이동했습니다';
    }
  });

  decimal.addEventListener('input', e => {
    const v = filterNumeric(e.target.value);
    e.target.value = v;
    toggleHasValue(decControl, v);
    if (v.length >= e.target.maxLength) {
      e.target.blur();
      announcer.textContent = '소수 입력이 완료되었습니다';
    }
  });

  // 포커스/블러 클래스 토글 (for showing clear button on focus)
  [integer, decimal].forEach(inp => {
    inp.addEventListener('focus', () => {
      const ctrl = inp.parentElement;
      ctrl.classList.add('focused');
      // 버튼 표시 결정: 포커스가 생기면 버튼 보임 (또는 값이 있을 때)
      toggleHasValue(ctrl, inp.value);
    });
    inp.addEventListener('blur', () => {
      const ctrl = inp.parentElement;
      ctrl.classList.remove('focused');
      // blur 후 값 없으면 버튼 숨김 (has-value 클래스 사용)
      toggleHasValue(ctrl, inp.value);
    });
  });

  // clear 버튼 동작 (각각 해당 인풋만 지움)
  clearInt.addEventListener('click', () => {
    integer.value = '';
    integer.focus();
    toggleHasValue(intControl, '');
    announcer.textContent = '정수 입력이 지워졌습니다';
  });
  clearDec.addEventListener('click', () => {
    decimal.value = '';
    decimal.focus();
    toggleHasValue(decControl, '');
    announcer.textContent = '소수 입력이 지워졌습니다';
  });

  // 컨트롤에 has-value 클래스 토글
  function toggleHasValue(controlEl, value){
    if (value && value.length > 0){
      controlEl.classList.add('has-value');
    } else {
      controlEl.classList.remove('has-value');
    }
  }

  // 키보드 편의: 정수에서 Delete 혹은 Backspace로 빈 상태에서 backspace 누르면 포커스 이전 처리 X (예시)
  // (필요시 더 고급 동작 추가 가능)
  integer.addEventListener('keydown', e => {
    if (e.key === '.' || e.key === ',' ) {
      // '.' 또는 ',' 누르면 소수부로 포커스 이동 (사용자 친화적)
      e.preventDefault();
      decimal.focus();
    }
  });

  // 폼 제출 시 합쳐서 값 만들기 예 (여기선 콘솔 출력만)
  // 예: 실제 폼 제출 시 document.createElement('input', {type:'hidden', name:'amount'}) 등으로 합친 값을 전송
  function getCombinedAmount(){
    const intV = integer.value.trim();
    const decV = decimal.value.trim();
    if (!intV && !decV) return '';
    return (intV || '0') + '.' + (decV.padEnd(2, '0').slice(0,2));
  }

  // 데모: 콘솔에 합쳐진 값 출력(테스트용)
  [integer, decimal].forEach(inp => inp.addEventListener('change', () => {
    console.log('합쳐진 금액:', getCombinedAmount());
  }));

  // 초기 상태 버튼 표시 (만약 placeholder만 있고 값 없으면 숨김)
  toggleHasValue(intControl, integer.value);
  toggleHasValue(decControl, decimal.value);
</script>
</body>
</html>
